<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FieldAgent - Collections</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
</head>
<!-- This page shows the agent all of their collections.
            It will show any overdue collections first, then show all collections
            that are due today, and finally show all collections in the future.
            The agent will be able to click on each collection to see more details
            about the collection.
            The agent will also be able to filter the collections by date using
            the date picker at the top of the page.
            The agent can also view all of their pending collections by clicking
            on the "Pending Collections" button at the top of the page.

            -->
<body class="bg-gray-100 min-h-screen pb-16">
    <!-- Top Navigation -->
    <nav class="bg-white shadow-md px-4 py-3 sticky top-0 z-10">
        <div class="flex justify-between items-center">
            <div class="flex items-center">
                <button id="menuToggle" class="mr-4 text-gray-600 focus:outline-none">
                    <i class="fas fa-bars text-lg"></i>
                </button>
                <h1 class="text-xl font-bold text-indigo-600">FieldAgent</h1>
            </div>
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <button id="notificationBtn" class="text-gray-600 focus:outline-none">
                        <i class="fas fa-bell text-lg"></i>
                        <span class="absolute top-0 right-0 transform translate-x-1/2 -translate-y-1/2 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center">3</span>
                    </button>
                </div>
                <div class="h-8 w-8 rounded-full bg-indigo-200 flex items-center justify-center text-indigo-700 font-semibold cursor-pointer" id="profileDropdown">
                    JS
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Sidebar Menu (Hidden by default on mobile) -->
    <div id="sidebar" class="fixed inset-y-0 left-0 bg-white w-64 shadow-lg transform -translate-x-full transition-transform duration-300 ease-in-out z-20">
        <div class="p-4 border-b">

            <div class="flex items-center">
                <div class="h-10 w-10 rounded-full bg-indigo-200 flex items-center justify-center text-indigo-700 font-semibold mr-3">
                    JS
                </div>
                <div>
                    <h2 class="text-lg font-semibold" id="agentName">John Smith</h2>
                    <p class="text-sm text-gray-600" id="agentId">Agent #A12345</p>
                </div>
            </div>
        </div>
        <nav class="mt-4">
            <a th:href="@{/agent/dashboard}" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-100">
                <i class="fas fa-th-large w-6"></i>
                <span>Dashboard</span>
            </a>
            <a th:href="@{/agent/activeRoute}" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-100">
                <i class="fas fa-route w-6"></i>
                <span>Active Route</span>
            </a>
            <a th:href="@{/agent/customers}" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-100">
                <i class="fas fa-users w-6"></i>
                <span>Customers</span>
            </a>
            <a th:href="@{agent/collection}" class="flex items-center px-4 py-3 text-indigo-600 bg-indigo-50 border-l-4 border-indigo-600">
                <i class="fas fa-money-bill-wave w-6"></i>
                <span>Collections</span>
            </a>
            <a th:href="@{/agent/history}" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-100">
                <i class="fas fa-history w-6"></i>
                <span>History</span>
            </a>
            <a th:href ="@{/agent/settings}" class="flex items-center px-4 py-3 text-gray-600 hover:bg-gray-100">
                <i class="fas fa-cog w-6"></i>
                <span>Settings</span>
            </a>
        </nav>
        <div class="absolute bottom-0 w-full border-t p-4">
            <button id="logoutBtn" class="w-full flex items-center justify-center px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg">
                <i class="fas fa-sign-out-alt mr-2"></i>
                <span>Logout</span>
            </button>
        </div>
    </div>
    
    <!-- Overlay for sidebar -->
    <div id="overlay" class="fixed inset-0 bg-black opacity-0 pointer-events-none transition-opacity duration-300 ease-in-out z-10"></div>
    
    <!-- Main Content -->
    <div class="container mx-auto px-4 py-6">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Collections</h2>
            <div class="flex space-x-2">
                <div class="relative">
                    <input type="date" id="dateFilter" class="pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <i class="fas fa-calendar absolute left-3 top-3 text-gray-400"></i>
                </div>
                <button id="filterBtn" class="px-4 py-2 border rounded-lg bg-white hover:bg-gray-50">
                    <i class="fas fa-filter text-gray-600"></i>
                </button>
            </div>
        </div>
        
        <!-- Summary Cards -->
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-white rounded-xl shadow-md p-4">
                <h3 class="text-sm text-gray-600 font-medium mb-1">Today's Collections</h3>
                <p class="text-2xl font-bold text-green-600" id="todayTotal">$0.00</p>
                <p class="text-xs text-gray-500 mt-1">From <span id="todayCount">0</span> customers</p>
            </div>
            <div class="bg-white rounded-xl shadow-md p-4">
                <h3 class="text-sm text-gray-600 font-medium mb-1">This Week</h3>
                <p class="text-2xl font-bold text-gray-800" id="weekTotal">$4,465.50</p>
                <p class="text-xs text-gray-500 mt-1">From <span id="weekCount">8</span> customers</p>
            </div>
        </div>
        
        <!-- Collections List -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden mb-6">
            <div class="p-4 border-b">
                <h3 class="font-medium">Recent Collections</h3>
            </div>
            
            <!-- Today Section -->
            <div class="px-4 py-2 bg-gray-50 text-sm font-medium text-gray-600">Today</div>
            <div id="todayCollectionsList" class="divide-y">
                <!-- No collections today message -->
                <div class="p-4 text-center text-gray-500 italic">
                    No collections recorded today
                </div>
            </div>
            
            <!-- Yesterday Section -->
            <div class="px-4 py-2 bg-gray-50 text-sm font-medium text-gray-600">Yesterday</div>
            <div class="divide-y">
                <!-- Collection Item -->
                <div class="p-4 hover:bg-gray-50 transition-colors duration-200">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">XYZ Corporation</h4>
                            <p class="text-sm text-gray-600">Invoice #INV-2025-0412</p>
                        </div>
                        <span class="text-lg font-semibold text-green-600">$875.50</span>
                    </div>
                    <div class="mt-2 flex justify-between items-center">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-clock mr-1"></i>
                            <span>10:42 AM</span>
                            <span class="mx-2">•</span>
                            <span>Cash</span>
                        </div>
                        <button class="text-indigo-600 text-sm hover:underline">View Receipt</button>
                    </div>
                </div>
                
                <!-- Collection Item -->
                <div class="p-4 hover:bg-gray-50 transition-colors duration-200">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">123 Industries</h4>
                            <p class="text-sm text-gray-600">Invoice #INV-2025-0404</p>
                        </div>
                        <span class="text-lg font-semibold text-green-600">$1,250.00</span>
                    </div>
                    <div class="mt-2 flex justify-between items-center">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-clock mr-1"></i>
                            <span>3:15 PM</span>
                            <span class="mx-2">•</span>
                            <span>Check #4532</span>
                        </div>
                        <button class="text-indigo-600 text-sm hover:underline">View Receipt</button>
                    </div>
                </div>
            </div>
            
            <!-- Previous Section -->
            <div class="px-4 py-2 bg-gray-50 text-sm font-medium text-gray-600">Previous</div>
            <div class="divide-y">
                <!-- Collection Item -->
                <div class="p-4 hover:bg-gray-50 transition-colors duration-200">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">Acme Corp</h4>
                            <p class="text-sm text-gray-600">Invoice #INV-2025-0397</p>
                        </div>
                        <span class="text-lg font-semibold text-green-600">$2,340.00</span>
                    </div>
                    <div class="mt-2 flex justify-between items-center">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-calendar mr-1"></i>
                            <span>April 5, 2025</span>
                            <span class="mx-2">•</span>
                            <span>Cash</span>
                        </div>
                        <button class="text-indigo-600 text-sm hover:underline">View Receipt</button>
                    </div>
                </div>
                
                <!-- Collection Item -->
                <div class="p-4 hover:bg-gray-50 transition-colors duration-200">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">Global Solutions Inc.</h4>
                            <p class="text-sm text-gray-600">Invoice #INV-2025-0385</p>
                        </div>
                        <span class="text-lg font-semibold text-green-600">$940.25</span>
                    </div>
                    <div class="mt-2 flex justify-between items-center">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-calendar mr-1"></i>
                            <span>April 4, 2025</span>
                            <span class="mx-2">•</span>
                            <span>Credit Card</span>
                        </div>
                        <button class="text-indigo-600 text-sm hover:underline">View Receipt</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Pending Collections -->
        <h3 class="text-lg font-semibold text-gray-800 mb-3">Pending Collections</h3>
        <div class="bg-white rounded-xl shadow-md overflow-hidden">
            <div class="divide-y">
                <!-- Pending Collection Item -->
                <div class="p-4 hover:bg-gray-50 transition-colors duration-200">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">ABC Company</h4>
                            <p class="text-sm text-gray-600">Invoice #INV-2025-0423</p>
                            <div class="flex items-center mt-1">
                                <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Due Today</span>
                            </div>
                        </div>
                        <span class="text-lg font-semibold text-gray-800">$1,250.00</span>
                    </div>
                    <div class="mt-2 flex justify-between items-center">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-map-marker-alt mr-1"></i>
                            <span>123 Main St, Suite 101</span>
                        </div>
                        <button class="text-indigo-600 text-sm hover:underline">Record Collection</button>
                    </div>
                </div>
                
                <!-- Pending Collection Item -->
                <div class="p-4 hover:bg-gray-50 transition-colors duration-200">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium">123 Industries</h4>
                            <p class="text-sm text-gray-600">Invoice #INV-2025-0427</p>
                            <div class="flex items-center mt-1">
                                <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded">Overdue</span>
                            </div>
                        </div>
                        <span class="text-lg font-semibold text-gray-800">$2,340.00</span>
                    </div>
                    <div class="mt-2 flex justify-between items-center">
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-map-marker-alt mr-1"></i>
                            <span>789 Pine St</span>
                        </div>
                        <button class="text-indigo-600 text-sm hover:underline">Record Collection</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <div class="fixed bottom-20 right-6">
        <button id="newCollectionBtn" class="h-14 w-14 rounded-full bg-green-600 text-white shadow-lg flex items-center justify-center">
            <i class="fas fa-dollar-sign text-xl"></i>
        </button>
    </div>
    
    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 inset-x-0 bg-white border-t shadow-lg z-10">
        <div class="flex justify-around">
            <a th:href="@{/agent/dashboard}" class="flex flex-col items-center py-2 flex-1 text-gray-500">
                <i class="fas fa-th-large text-lg"></i>
                <span class="text-xs mt-1">Dashboard</span>
            </a>
            <a th:href="@{/agent/activeRoute}" class="flex flex-col items-center py-2 flex-1 text-gray-500">
                <i class="fas fa-route text-lg"></i>
                <span class="text-xs mt-1">Route</span>
            </a>
            <a th:href="@{/agent/visit}" class="flex flex-col items-center py-2 flex-1 text-gray-500">
                <i class="fas fa-clipboard-check text-lg"></i>
                <span class="text-xs mt-1">Visit</span>
            </a>
            <a th:href="@{/agent/collection}" class="flex flex-col items-center py-2 flex-1 text-indigo-600 border-t-2 border-indigo-600">
                <i class="fas fa-hand-holding-usd text-lg"></i>
                <span class="text-xs mt-1">Collect</span>
            </a>
            <a th:href="@{/agent/more}" class="flex flex-col items-center py-2 flex-1 text-gray-500">
                <i class="fas fa-ellipsis-h text-lg"></i>
                <span class="text-xs mt-1">More</span>
            </a>
        </div>
    </nav>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Sidebar toggle functionality
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            
            menuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('-translate-x-full');
                overlay.classList.toggle('opacity-0');
                overlay.classList.toggle('pointer-events-none');
            });
            
            overlay.addEventListener('click', function() {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('opacity-0');
                overlay.classList.add('pointer-events-none');
            });
            
            // New collection button
            const newCollectionBtn = document.getElementById('newCollectionBtn');
            
            newCollectionBtn.addEventListener('click', function() {
                window.location.href = '/agent/collection';
            });
            
            // Load user data
            const username = localStorage.getItem('username') || 'John Smith';
            document.getElementById('agentName').textContent = username;
            
            // Set initials
            const nameParts = username.split(' ');
            let initials = '';
            if (nameParts.length >= 2) {
                initials = nameParts[0].charAt(0) + nameParts[1].charAt(0);
            } else {
                initials = nameParts[0].charAt(0);
            }
            
            document.getElementById('profileDropdown').textContent = initials;
            
            // Set current date for filter
            const today = new Date();
            const dateStr = today.toISOString().split('T')[0];
            document.getElementById('dateFilter').value = dateStr;
            
            // Load collection summaries
            loadCollectionSummaries();
            
            // Filter button
            const filterBtn = document.getElementById('filterBtn');
            
            filterBtn.addEventListener('click', function() {
                const selectedDate = document.getElementById('dateFilter').value;
                console.log('Filtering collections for date:', selectedDate);
                // In a real app, this would filter the collection list
            });
        });
        
        function loadCollectionSummaries() {
            // In a real app, this would fetch data from an API or local storage
            // For this demo, we'll use mock data
            
            // Today's collections summary
            const todayTotal = localStorage.getItem('todayCollections') || '0.00';
            const todayCount = localStorage.getItem('todayCollectionsCount') || '0';
            
            document.getElementById('todayTotal').textContent = '$' + todayTotal;
            document.getElementById('todayCount').textContent = todayCount;
            
            // If there are collections today, update the list
            if (todayCount > 0) {
                // This would populate actual collection data in a real app
                document.getElementById('todayCollectionsList').innerHTML = `
                    <!-- This would be dynamic in a real app -->
                    <div class="p-4 hover:bg-gray-50 transition-colors duration-200">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium">ABC Company</h4>
                                <p class="text-sm text-gray-600">Invoice #INV-2025-0423</p>
                            </div>
                            <span class="text-lg font-semibold text-green-600">$1,250.00</span>
                        </div>
                        <div class="mt-2 flex justify-between items-center">
                            <div class="flex items-center text-sm text-gray-500">
                                <i class="fas fa-clock mr-1"></i>
                                <span>9:30 AM</span>
                                <span class="mx-2">•</span>
                                <span>Cash</span>
                            </div>
                            <button class="text-indigo-600 text-sm hover:underline">View Receipt</button>
                        </div>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>